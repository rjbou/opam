N0REP0
### ::: Setup :::
### <hello>
Hi robur!
### tar czf archive.tgz hello
### <p.patch>
Trust me, im' a patch!
### openssl md5 archive.tgz | 'MD5[(]archive.tgz[)]= ' -> '' >$ ARCHIVE_MD5
### openssl sha256 archive.tgz | 'SHA2-256[(]archive.tgz[)]= ' -> '' >$ ARCHIVE_SHA256
### openssl md5 p.patch | 'MD5[(]p.patch[)]= ' -> '' >$ PATCH_MD5
### openssl sha256 p.patch | 'SHA2-256[(]p.patch[)]= ' -> '' >$ PATCH_SHA256
### <update-hash.sh>
set -ue
hsh=$1
kind=$2
pkg=$3
case "$hsh-$kind" in
  md5-archive)
    HSH=$ARCHIVE_MD5
    break;;
  sha256-archive)
    HSH=$ARCHIVE_SHA256
    break;;
  md5-patch)
    HSH=$PATCH_MD5
    break;;
  sha256-patch)
    HSH=$PATCH_SHA256
    break;;
esac
pkgpath="REPO/packages/${pkg%.*}/$pkg"
sed -i "s/good-$hsh/$HSH/" "$pkgpath/opam"
if [ "$kind" = "patch" ] && ! [ -d $pkgpath/files ] ; then
  mkdir $pkgpath/files
  cp p.patch $pkgpath/files/
fi
### <pkg:good-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [ "md5=good-md5" ]
}
### sh update-hash.sh md5 archive good-md5.1
### <pkg:good-sha256.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [ "sha256=good-sha256" ]
}
### sh update-hash.sh sha256 archive good-sha256.1
### <pkg:good-md5-good-sha256.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [
    "md5=good-md5"
    "sha256=good-sha256"
  ]
}
### sh update-hash.sh md5 archive good-md5-good-sha256.1
### sh update-hash.sh sha256 archive good-md5-good-sha256.1
### <pkg:good-sha256-good-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [
    "md5=good-md5"
    "sha256=good-sha256"
  ]
}
### sh update-hash.sh md5 archive good-sha256-good-md5.1
### sh update-hash.sh sha256 archive good-sha256-good-md5.1
### <pkg:no-checksum.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url { src: "archive.tgz" }
### <pkg:multiple-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [
    "md5=good-md5"
    "md5=00000000000000000000000000000000"
  ]
}
### sh update-hash.sh md5 archive multiple-md5.1
### <pkg:bad-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [ "md5=00000000000000000000000000000000" ]
}
### <pkg:good-md5-bad-sha256.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [
    "md5=good-md5"
    "sha256=0000000000000000000000000000000000000000000000000000000000000000"
  ]
}
### sh update-hash.sh md5 archive good-md5-bad-sha256.1
### <pkg:good-sha256-bad-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [
    "sha256=good-sha256"
    "md5=00000000000000000000000000000000"
  ]
}
### sh update-hash.sh sha256 archive good-sha256-bad-md5.1
### <pkg:clash-with-all-md5s.666>
opam-version: "2.0"
maintainer: "Satan"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "A (less) very evil package"
build: [ "test" "-f" "hello" ]
url {
  src: "archive.tgz"
  checksum: [
    "md5=00000000000000000000000000000000"
    "md5=11111111111111111111111111111111"
    "md5=22222222222222222222222222222222"
    "md5=33333333333333333333333333333333"
    "md5=44444444444444444444444444444444"
    "md5=good-md5"
    "md5=55555555555555555555555555555555"
    "md5=66666666666666666666666666666666"
    "md5=77777777777777777777777777777777"
    "md5=88888888888888888888888888888888"
    "md5=99999999999999999999999999999999"
    "md5=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
    "md5=bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb"
    "md5=cccccccccccccccccccccccccccccccc"
    "md5=dddddddddddddddddddddddddddddddd"
    "md5=eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"
    "md5=ffffffffffffffffffffffffffffffff"
    "sha256=0123456789abcdeffedcba98765432100123456789abcdeffedbca9876543210"
  ]
}
### sh update-hash.sh md5 archive clash-with-all-md5s.666
### <pkg:extra-good-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["p.patch" "md5=good-md5"]
]
### sh update-hash.sh md5 patch extra-good-md5.1
### <pkg:extra-good-md5-good-sha256.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["p.patch" "md5=good-md5"]
  ["p.patch" "sha256=good-sha256"]
]
### sh update-hash.sh md5 patch extra-good-md5-good-sha256.1
### sh update-hash.sh sha256 patch extra-good-md5-good-sha256.1
### <pkg:extra-bad-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["p.patch" "md5=00000000000000000000000000000000"]
]
### # no substitution, for populating
### sh update-hash.sh md5 patch extra-bad-md5.1
### <pkg:extra-good-md5-bad-sha256.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["p.patch" "md5=good-md5"]
  ["p.patch" "sha256=0000000000000000000000000000000000000000000000000000000000000000"]
]
### sh update-hash.sh md5 patch extra-good-md5-bad-sha256.1
### <pkg:extra-no-checksum.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["p.patch"]
]
### # no substitution, for populating
### sh update-hash.sh md5 patch extra-no-checksum.1
### <pkg:extra-not-mentionned.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
### sh update-hash.sh md5 patch extra-not-mentionned.1
### <pkg:extra-not-present.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["p.patch" "md5=00000000000000000000000000000000"]
]
### <pkg:escape-absolute.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
extra-files: [
  ["/etc/passwdd" "md5=c316eacc19a12732bb894667a08e9c14"]
]
### <pkg:extra-escape-good-md5.1>
opam-version: "2.0"
maintainer: "nobody"
authors: "nobody neither"
homepage: "https://no.bo.dy"
bug-reports: "https://still.nobo.dy"
dev-repo: "git+https://no.were"
license: "MIT"
synopsis: "Initially empty"
build: [ "test" "-f" "p.patch" ]
extra-files: [
  ["../../../extra-no-checksum/extra-no-checksum.1/files/p.patch" "md5=good-md5"]
]
### sh update-hash.sh md5 patch extra-escape-good-md5.1
### opam update default

<><> Updating package repositories ><><><><><><><><><><><><><><><><><><><><><><>
[default] synchronised from file://${BASEDIR}/REPO
Now run 'opam upgrade' to apply any package updates.
### opam switch create --empty robur
### OPAMSTRICT=no
### :::::::::::::::::
### :I: Hashes
### :::::::::::::::::
### :I:1: good md5
### opam lint --package good-md5
<default>/good-md5.1: Passed.
### opam install good-md5
The following actions will be performed:
=== install 1 package
  - install good-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> retrieved good-md5.1  (file://${BASEDIR}/archive.tgz)
-> installed good-md5.1
Done.
### opam source good-md5
Successfully extracted to ${BASEDIR}/good-md5.1
### test -f good-md5.1/hello
### :I:2: good sha256
### opam lint --package good-sha256
<default>/good-sha256.1: Passed.
### opam install good-sha256
The following actions will be performed:
=== install 1 package
  - install good-sha256 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> retrieved good-sha256.1  (file://${BASEDIR}/archive.tgz)
-> installed good-sha256.1
Done.
### opam source good-sha256
Successfully extracted to ${BASEDIR}/good-sha256.1
### test -f good-sha256.1/hello
### :I:3: good md5 & sha256
### opam lint --package good-md5-good-sha256
<default>/good-md5-good-sha256.1: Passed.
### opam install good-md5-good-sha256
The following actions will be performed:
=== install 1 package
  - install good-md5-good-sha256 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> retrieved good-md5-good-sha256.1  (cached)
-> installed good-md5-good-sha256.1
Done.
### opam source good-md5-good-sha256
Successfully extracted to ${BASEDIR}/good-md5-good-sha256.1
### test -f good-md5-good-sha256.1/hello
### :I:4: good sha256 & good md5
### opam lint --package good-sha256-good-md5
<default>/good-sha256-good-md5.1: Passed.
### opam install good-sha256-good-md5
The following actions will be performed:
=== install 1 package
  - install good-sha256-good-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> retrieved good-sha256-good-md5.1  (cached)
-> installed good-sha256-good-md5.1
Done.
### opam source good-sha256-good-md5
Successfully extracted to ${BASEDIR}/good-sha256-good-md5.1
### test -f good-sha256-good-md5.1/hello
### :I:4: no checksum
### opam lint --package no-checksum
<default>/no-checksum.1: Passed.
### opam install no-checksum
The following actions will be performed:
=== install 1 package
  - install no-checksum 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> retrieved no-checksum.1  (file://${BASEDIR}/archive.tgz)
-> installed no-checksum.1
Done.
### opam source no-checksum
Successfully extracted to ${BASEDIR}/no-checksum.1
### test -f no-checksum.1/hello
### :I:5: multiple md5
### opam lint --package multiple-md5
<default>/multiple-md5.1: Passed.
### opam install multiple-md5 | '[0-9a-z]{32}' -> 'hash'
The following actions will be performed:
=== install 1 package
  - install multiple-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ERROR] Conflicting file hashes, or broken or compromised cache!
          - md5=hash (match)
          - md5=hash (MISMATCH)

[ERROR] multiple-md5.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Failed to get sources of multiple-md5.1: Checksum mismatch

OpamSolution.Fetch_fail("Checksum mismatch")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - fetch multiple-md5 1
+- 
- No changes have been performed
# Return code 40 #
### opam source multiple-md5 | '[0-9a-z]{32}' -> 'hash'
[ERROR] multiple-md5.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Download failed: Checksum mismatch
# Return code 40 #
### test -f multiple-md5.1/hello
# Return code 1 #
### :I:6: bad md5
### opam lint --package bad-md5
<default>/bad-md5.1: Passed.
### opam install bad-md5 | '[0-9a-z]{32}' -> 'hash'
The following actions will be performed:
=== install 1 package
  - install bad-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ERROR] bad-md5.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Failed to get sources of bad-md5.1: Checksum mismatch

OpamSolution.Fetch_fail("Checksum mismatch")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - fetch bad-md5 1
+- 
- No changes have been performed
# Return code 40 #
### opam source bad-md5 | '[0-9a-z]{32}' -> 'hash'
[ERROR] bad-md5.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Download failed: Checksum mismatch
# Return code 40 #
### test -f bad-md5.1/hello
# Return code 1 #
### :I:7: good md5 & bad sha256
### opam lint --package good-md5-bad-sha256
<default>/good-md5-bad-sha256.1: Passed.
### opam install good-md5-bad-sha256 | '[0-9a-z]{32,64}' -> 'hash'
The following actions will be performed:
=== install 1 package
  - install good-md5-bad-sha256 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ERROR] good-md5-bad-sha256.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected sha256=hash
          got      sha256=hash
[ERROR] Failed to get sources of good-md5-bad-sha256.1: Checksum mismatch

OpamSolution.Fetch_fail("Checksum mismatch")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - fetch good-md5-bad-sha256 1
+- 
- No changes have been performed
# Return code 40 #
### opam source good-md5-bad-sha256 | '[0-9a-z]{64}' -> 'md5'
[ERROR] good-md5-bad-sha256.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected sha256=md5
          got      sha256=md5
[ERROR] Download failed: Checksum mismatch
# Return code 40 #
### test -f good-md5-bad-sha256.1/hello
# Return code 1 #
### :I:8: good sha256 & bad md5
### opam lint --package good-sha256-bad-md5
<default>/good-sha256-bad-md5.1: Passed.
### opam install good-sha256-bad-md5 | '[0-9a-z]{32,64}' -> 'hash'
The following actions will be performed:
=== install 1 package
  - install good-sha256-bad-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ERROR] Conflicting file hashes, or broken or compromised cache!
          - sha256=hash (match)
          - md5=hash (MISMATCH)

[ERROR] good-sha256-bad-md5.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Failed to get sources of good-sha256-bad-md5.1: Checksum mismatch

OpamSolution.Fetch_fail("Checksum mismatch")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - fetch good-sha256-bad-md5 1
+- 
- No changes have been performed
# Return code 40 #
### opam source good-sha256-bad-md5 | '[0-9a-z]{32}' -> 'hash'
[ERROR] good-sha256-bad-md5.1: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Download failed: Checksum mismatch
# Return code 40 #
### test -f good-sha256-bad-md5.1/hello
# Return code 1 #
### :I:10: clash with all md5
### opam lint --package clash-with-all-md5s
<default>/clash-with-all-md5s.666: Passed.
### opam install clash-with-all-md5s | '[0-9a-z]{32}' -> 'hash'
The following actions will be performed:
=== install 1 package
  - install clash-with-all-md5s 666

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ERROR] clash-with-all-md5s.666: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Failed to get sources of clash-with-all-md5s.666: Checksum mismatch

OpamSolution.Fetch_fail("Checksum mismatch")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - fetch clash-with-all-md5s 666
+- 
- No changes have been performed
# Return code 40 #
### opam source clash-with-all-md5s | '[0-9a-z]{32}' -> 'hash'
[ERROR] clash-with-all-md5s.666: Checksum mismatch for file://${BASEDIR}/archive.tgz:
          expected md5=hash
          got      md5=hash
[ERROR] Download failed: Checksum mismatch
# Return code 40 #
### test -f clash-with-all-md5s.666/hello
# Return code 1 #
### :::::::::::::::::
### :II: Extra-files
### :::::::::::::::::
### :II:1: Hashes
### :II:1:a: good md5
### opam lint --package extra-good-md5
<default>/extra-good-md5.1: Errors.
             error 53: Mismatching 'extra-files:' field: "p.patch"
# Return code 1 #
### opam install extra-good-md5
The following actions will be performed:
=== install 1 package
  - install extra-good-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed extra-good-md5.1
Done.
### opam source extra-good-md5
Successfully extracted to ${BASEDIR}/extra-good-md5.1
### test -f extra-good-md5.1/p.patch
### :II:1:b: good md5 & sha256
### opam lint --package extra-good-md5-good-sha256
<default>/extra-good-md5-good-sha256.1: Errors.
             error 53: Mismatching 'extra-files:' field: "p.patch", "p.patch"
# Return code 1 #
### opam install extra-good-md5-good-sha256
The following actions will be performed:
=== install 1 package
  - install extra-good-md5-good-sha256 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed extra-good-md5-good-sha256.1
Done.
### opam source extra-good-md5-good-sha256
Successfully extracted to ${BASEDIR}/extra-good-md5-good-sha256.1
### test -f extra-good-md5-good-sha256.1/p.patch
### :II:1:c: bad md5
### opam lint --package extra-bad-md5
<default>/extra-bad-md5.1: Errors.
             error 53: Mismatching 'extra-files:' field: "p.patch"
# Return code 1 #
### opam install extra-bad-md5
The following actions will be performed:
=== install 1 package
  - install extra-bad-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Bad hash for   - ${BASEDIR}/OPAM/repo/default/packages/extra-bad-md5/extra-bad-md5.1/files/p.patch



<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build extra-bad-md5 1
+- 
- No changes have been performed
# Return code 31 #
### opam source extra-bad-md5
[WARNING] Some errors extracting to ${BASEDIR}/extra-bad-md5.1: Failure("Bad hash for   - ${BASEDIR}/OPAM/repo/default/packages/extra-bad-md5/extra-bad-md5.1/files/p.patch\n")

### test -f extra-bad-md5.1/p.patch
# Return code 1 #
### :II:1:d: good md5 & bad sha256
### opam lint --package extra-good-md5-bad-sha256
<default>/extra-good-md5-bad-sha256.1: Errors.
             error 53: Mismatching 'extra-files:' field: "p.patch", "p.patch"
# Return code 1 #
### opam install extra-good-md5-bad-sha256
The following actions will be performed:
=== install 1 package
  - install extra-good-md5-bad-sha256 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Bad hash for   - ${BASEDIR}/OPAM/repo/default/packages/extra-good-md5-bad-sha256/extra-good-md5-bad-sha256.1/files/p.patch



<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build extra-good-md5-bad-sha256 1
+- 
- No changes have been performed
# Return code 31 #
### opam source extra-good-md5-bad-sha256
[WARNING] Some errors extracting to ${BASEDIR}/extra-good-md5-bad-sha256.1: Failure("Bad hash for   - ${BASEDIR}/OPAM/repo/default/packages/extra-good-md5-bad-sha256/extra-good-md5-bad-sha256.1/files/p.patch\n")

### test -f extra-good-md5-bad-sha256.1/p.patch
### :II:1:e: no checksum
### opam lint --package extra-no-checksum
<default>/extra-no-checksum.1: Errors.
             error  3: File format error in 'extra-files' at line 11, column 2: expected [file checksum]
# Return code 1 #
### opam install extra-no-checksum
[ERROR] In the opam file for extra-no-checksum.1:
          - At ${BASEDIR}/OPAM/repo/default/packages/extra-no-checksum/extra-no-checksum.1/opam:11:2-11:13::
            expected [file checksum]
        'extra-files' has been ignored.
The following actions will be performed:
=== install 1 package
  - install extra-no-checksum 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed extra-no-checksum.1
Done.
### opam source extra-no-checksum
Successfully extracted to ${BASEDIR}/extra-no-checksum.1
### test -f extra-no-checksum.1/p.patch
### :II:2: Presence
### :II:2:a: not mentionned
### opam lint --package extra-not-mentionned
<default>/extra-not-mentionned.1: Passed.
### opam install extra-not-mentionned
The following actions will be performed:
=== install 1 package
  - install extra-not-mentionned 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> installed extra-not-mentionned.1
Done.
### opam source extra-not-mentionned
Successfully extracted to ${BASEDIR}/extra-not-mentionned.1
### test -f extra-not-mentionned.1/p.patch
### :II:2:b: not present
### opam lint --package extra-not-present
<default>/extra-not-present.1: Errors.
             error 53: Mismatching 'extra-files:' field: "p.patch"
# Return code 1 #
### opam install extra-not-present
The following actions will be performed:
=== install 1 package
  - install extra-not-present 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Sys_error("${BASEDIR}/OPAM/repo/default/packages/extra-not-present/extra-not-present.1/files/p.patch: No such file or directory")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build extra-not-present 1
+- 
- No changes have been performed
# Return code 31 #
### opam source extra-not-present
Fatal error:
Sys_error("${BASEDIR}/OPAM/repo/default/packages/extra-not-present/extra-not-present.1/files/p.patch: No such file or directory")
# Return code 99 #
### test -f extra-not-present.1/p.patch
# Return code 1 #
### :II:3: Escaping
### :II:3:a: absolute
### opam lint --package escape-absolute
<default>/escape-absolute.1: Errors.
             error 53: Mismatching 'extra-files:' field: "/etc/passwdd"
# Return code 1 #
### opam install escape-absolute
The following actions will be performed:
=== install 1 package
  - install escape-absolute 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Sys_error("${BASEDIR}/OPAM/repo/default/packages/escape-absolute/escape-absolute.1/files//etc/passwdd: No such file or directory")


<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build escape-absolute 1
+- 
- No changes have been performed
# Return code 31 #
### opam source escape-absolute
Fatal error:
Sys_error("${BASEDIR}/OPAM/repo/default/packages/escape-absolute/escape-absolute.1/files//etc/passwdd: No such file or directory")
# Return code 99 #
### test -f escape-absolute.1/p.patch
# Return code 1 #
### :II:3:b: good md5
### opam lint --package extra-escape-good-md5
<default>/extra-escape-good-md5.1: Errors.
             error 53: Mismatching 'extra-files:' field: "../../../extra-no-checksum/extra-no-checksum.1/files/p.patch"
# Return code 1 #
### # ERROR it copies it to build dir ^ relative path -> escape!!!!
### # currently writing in /tmp as a common it copies in
### # /tmp/build_d2b6ce_dune/opam-reftest-8f9413/extra-escape-good-md5.1/../../../extra-no-checksum/extra-no-checksum.1/files
### opam install extra-escape-good-md5
The following actions will be performed:
=== install 1 package
  - install extra-escape-good-md5 1

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
[ERROR] The compilation of extra-escape-good-md5.1 failed at "test -f p.patch".




<><> Error report <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
+- The following actions failed
| - build extra-escape-good-md5 1
+- 
- No changes have been performed
# Return code 31 #
### opam source extra-escape-good-md5
Successfully extracted to ${BASEDIR}/extra-escape-good-md5.1
### test -f extra-escape-good-md5.1/p.patch
# Return code 1 #
